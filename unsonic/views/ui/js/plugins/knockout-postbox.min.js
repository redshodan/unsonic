//knockout-postbox 0.3.0 | (c) 2013 Ryan Niemeyer | http://www.opensource.org/licenses/mit-license
!function(e){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?e(require("knockout"),exports):typeof define=="function"&&define.amd?define(["knockout","exports"],e):e(ko,ko.postbox={})}(function(e,t,n){var r,i;e.subscribable.call(t),t.topicCache={},t.serializer=e.toJSON,t.publish=function(e,n){e&&(t.topicCache[e]={value:n,serialized:t.serializer(n)},t.notifySubscribers(n,e))},i=t.subscribe,t.subscribe=function(e,n,r){if(e)return i.call(t,n,r,e)},t.defaultComparer=function(e,n){return n&&t.serializer(e)===n.serialized},e.subscribable.fn.publishOn=function(e,n,i){var s;return e&&(typeof n=="function"?i=n:s=n,i=i||t.defaultComparer,r.call(this,e,"publishOn"),this.postboxSubs[e].publishOn=this.subscribe(function(n){i.call(this,n,t.topicCache[e])||t.publish(e,n)},this),s||t.publish(e,this())),this},r=function(e,t){var n=this.postboxSubs=this.postboxSubs||{};n[e]=n[e]||{},n[e][t]&&n[e][t].dispose()},e.subscribable.fn.stopPublishingOn=function(e){return r.call(this,e,"publishOn"),this},e.subscribable.fn.subscribeTo=function(i,s,o){var u,a,f,l=this;return typeof s=="function"?o=s:u=s,i&&e.isWriteableObservable(this)&&(r.call(this,i,"subscribeTo"),f=function(e){l(o?o.call(l,e):e)},this.postboxSubs[i].subscribeTo=t.subscribe(i,f),u&&(a=t.topicCache[i],a!==n&&f(a.value))),this},e.subscribable.fn.unsubscribeFrom=function(e){return r.call(this,e,"subscribeTo"),this},e.subscribable.fn.syncWith=function(e,t,n,r){return this.subscribeTo(e,t).publishOn(e,n,r),this}})